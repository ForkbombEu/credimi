# SPDX-FileCopyrightText: 2025 Forkbomb BV
#
# SPDX-License-Identifier: AGPL-3.0-or-later

version: "1.1"
name: EWC flow
env:
  DSS_API: https://ewc.api.forkbomb.eu
tests:
  Test_case_14:
    steps:
      - name: QES‑style transaction authorisation; VP request carries base64url‑encoded tx‑data, wallet binds tx‑data hash in key‑binding JWT.
        http:
          url: ${{ env.DSS_API }}/vp/request
          method: GET
          params:
            sessionId: [[.session_id | toString]]
            client_id_scheme: x509
            profile: tx
            credential_profile: pid
            request_uri_method: post
            response_mode: direct_post
            tx_data: true
          check:
            status: 200
          captures:
            qr:
              jsonpath: $.qr
            deeplink:
              jsonpath: $.deepLink
            session_id:
              jsonpath: $.sessionId
